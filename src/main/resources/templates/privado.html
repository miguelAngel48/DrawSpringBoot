<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <link rel="stylesheet" th:href="@{/css/comon.css}" type="text/css" />
    <link rel="stylesheet" th:href="@{/css/draw.css}" type="text/css" />
    <meta charset="UTF-8">
    <title>privado</title>
</head>

<body>
    <header>
        <h2>
            Hello <b id="user" name="user" th:text="${user}"></b>
        </h2>
        <a th:href="@{/privado}" name="galery">Private Galery</a>
        <a th:href="@{/galery}" name="galery">Public Galery</a>
        <a th:href="@{/lienzo}" name="draw">Draw</a>
        <a th:href="@{/login}" name="logout">Logout</a>
    </header>

    <table id="galery">
        <tr>

            <th id="ownGalery" th:text="'galery of '+ ${user}" colspan="6"></th>
            <th><a th:href="@{/trash}" name="trash">Deleted Drawings</a></th>
        </tr>
        <tr>
            <th>Preview</th>
            <th>ID</th>
            <th>Draw name</th>
            <th>creation date</th>
            <th>width</th>
            <th>height</th>
            <th>share with id user</th>
            <th>redraw</th>
            <th>publicate</th>
            <th>delete</th>

        </tr>

        <tr th:each="draw : ${draws}" class="unitsGalery">
            <th><canvas class="draw-preview" width="80" height="80"></canvas>
                <input type="hidden" class="shapesPreview" th:value="${draw.jsonShapes}"
                    th:attr="data-shapes=${draw.jsonShapes}">
            </th>
            <th th:text="${draw.id}"></th>
            <th th:text="${draw.drawName}"></th>
            <th th:text="${draw.DateCreate}"></th>
            <th th:text="${draw.width}+ 'px'"></th>
            <th th:text="${draw.height}+ 'px'"></th>
            <td>
                <form action="/share" method="post">
                    <input type="hidden" name="id" th:value="${draw.id}">
                    <input type="number" name="idUser" placeholder="User ID" required>
                    <select name="permission">
                        <option value="VIEW">View</option>
                        <option value="EDIT">Edit</option>
                    </select>
                    <button type="submit">Share</button>
                </form>
            </td>
            <th>
                <a th:if="${user == draw.name}" th:href="@{'/lienzo/get/'+ ${draw.id}}">
                    redraw
                </a>
            </th>
            <th>
                <form action="/publicated" method="post">
                    <input type="hidden" name="id" th:value="${draw.id}">
                    <button type="submit"><svg width="30" height="30" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M16.719 19.7519L16.0785 14.6279C15.8908 13.1266 14.6146 12 13.1017 12H12H10.8983C9.38538 12 8.10917 13.1266 7.92151 14.6279L7.28101 19.7519C7.1318 20.9456 8.06257 22 9.26556 22H12H14.7344C15.9374 22 16.8682 20.9456 16.719 19.7519Z"
                                stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                            <circle cx="12" cy="5" r="3" stroke="#ffffff" stroke-width="2"></circle>
                            <circle cx="4" cy="9" r="2" stroke="#ffffff" stroke-width="2"></circle>
                            <circle cx="20" cy="9" r="2" stroke="#ffffff" stroke-width="2"></circle>
                            <path
                                d="M4 14H3.69425C2.71658 14 1.8822 14.7068 1.72147 15.6712L1.38813 17.6712C1.18496 18.8903 2.12504 20 3.36092 20H7"
                                stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                            <path
                                d="M20 14H20.3057C21.2834 14 22.1178 14.7068 22.2785 15.6712L22.6119 17.6712C22.815 18.8903 21.8751 20 20.6392 20C19.4775 20 18.0952 20 17 20"
                                stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                        </svg></button>
                </form>
            </th>
            <th>
                <form action="/delete" method="post">
                    <input type="hidden" name="id" th:value="${draw.id}">
                    <button type="submit"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24"
                            height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                            <line x1="10" y1="11" x2="10" y2="17"></line>
                            <line x1="14" y1="11" x2="14" y2="17"></line>
                        </svg></button>
                </form>
            </th>

        </tr>
    </table>



    <table id="sharedWithYou">
        <tr>
            <th colspan="3">
                <h2>Shared with you</h2>
            </th>
        </tr>
        <tr>
            <th>Preview</th>
            <th>Draw ID</th>
            <th>Permission</th>
            <th>Action</th>
        </tr>

        <tr th:each="share : ${sharedWithMe}">
            <th><canvas class="draw-preview" width="80" height="80"></canvas>
                <input type="hidden" class="shapesPreview" th:value="${share.shapes}"
                    th:attr="data-shapes=${share.shapes}">
            </th>
            <td th:text="${share.drawId}"></td>
            <td th:text="${share.permission}"></td>
            <td>


                <a th:if="${share.permission.name() == 'VIEW'}" th:href="@{'/lienzo/preview/' + ${share.drawId}}">
                    Open
                </a>


                <a th:if="${share.permission.name() == 'EDIT'}" th:href="@{'/lienzo/copy/' + ${share.drawId}}">
                    Copy
                </a>

            </td>
        </tr>
    </table>


    <script th:src="@{/scripts/galery.js}"></script>
</body>

</html>